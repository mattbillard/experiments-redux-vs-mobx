import React from 'react';
import { useDispatch, useSelector } from "react-redux";

import { getJsonData, RootState, selectJsonData, setFoo } from '../../redux';

export const JsonData = () => {
  const { error, status } = useSelector((state: RootState) => state.jsonDataReducer);
  const jsonData = useSelector(selectJsonData);
  const dispatch = useDispatch();

  return (
    <div>
      <h2>JsonData</h2>
      <button onClick={() => dispatch(getJsonData(true))}>Get Data (Successful)</button>
      <button onClick={() => dispatch(getJsonData(false))}>Get Data (Error)</button>
      
      <br /><br />

      {/* NOTE: these checks need to be slightly different b/c of the code auto-generated by Redux Tookit to handle async fetching */}
      {status === 'loading' && (
        <div>Loading...</div>
      )}
      {status === 'failed' && (
        <div className="error">{error}</div>
      )}
     
      {status === 'succeeded' && (
        <div>
          <input type="text" onChange={(event) => dispatch(setFoo(event.target.value))} value={jsonData.deeply.nested.value.foo} />
          <pre>{JSON.stringify(jsonData, null, '  ')}</pre>
        </div>
      )}
    </div>
  );
};
